# coding=utf-8

import requests

# 统一通道  返回TGC的cookie
baseurl="http://mysso.cust.edu.cn/cas/login?service=https://portal.cust.edu.cn/custp/shiro-cas" # 得到TGC cookie

first_data={
    "username":"2018002999",
    "password":"xq000812Mm.cn",
    "execution":"3d67d514-a563-422f-9434-596221fdb877_ZXlKaGJHY2lPaUpJVXpVeE1pSjkucDBIRXpFb2IxNjV6eW5PSHpnMkczWTBYbDRGWHFaTUtsb0RSUWduS3hXSnlwcVh6NXJRRWNpWnJONlo3NnhNZjFhd2lWME1CVzd2S1JEdU14cVBxNjZVWExRcHF2S2dvQU9tcVBmalREdTZMN25USnlBVXNRanpXd2ExTldUQXRmSURvZjN2aHNHbHVXcEMwR1JGWHQ0L0tkWm54K3hoRTFOeTZlb2tnbkJSNkcwM2t0MzB5OFhaVUpZcU5Jb1ZmQzN5amJvOUFQMGYxVFpEQnJRemRERDIyZlk4U1BZT1RDNXFyTlFSUE9mR0hSTHJqYkpWdjhYNzUrdHdxcE90T2JYOEZRVUJKVVBuUnFzNlhIaHNhS2hkRlJPZnRBcWw2S0U0Vm1wVEp6RmZja0U2MXRqWW5JNHBRTkFQY052NGpRQk5FMUt4WFpXcVlHM1l6UVAvR1k0cE52UVlUdUZzM0NOVGxVWFpzcWJ3QWVqSmdpWlhtZzlNajg1UUhXUkJ0a09JLzFYdDMybU9XNVI4OEEwQkV4MUd1RXNOWWpNMjRrUmdPTFdLa1FKR3lFNVRVcnQ5ZU55OEpYbU15NDJFM2MvTlE2UVJsTWx6Q0hHTlJySWwvV0ZUM1ZiZUd5UzU0VGphd0hPZ05oVWYxWnkxVzVDdk1NZTMvSTNWczJyV0x0a3JBd0dMVzE5RmRzWjBGVHdJS3J5MDZkeUt2MGxKSmd0bHpHb1FWNmdtQXF0MDVtTldTenJYc0NGYkxlTFdXSkdFZ3o1OWJXRjQrV1lkRjJPNXhaeDZMRFVlY0E2cDJJZ0k3ZUpDbyt0RCt0bzdXQ2M0UHZud1RBbTc1azdRRzJ0aGZIOTM1TUwwdEpoZDBCcWFSbmZhN1c4WVZZemVNZ1NORHU0ZVR5UzFXM3BQOC9IWVNRdllOdDd1ZkZsSkdYbnJXZjJ2ZVgvN05vUTRlbG83SjhCNk54bDRBbE5VR2hFWUdrQ3BuWXd0eXNYK2kva21UVjVBSXlod3lFcCtscGdzRWJacFdUMmhtV0FJZlZRN1ZzSlI0VC9KVllkOTN5RXJmZzRHa0t1ODFpTVJhNllTZWRZMnppalBmcjd2QS9CZ1hiOXM1V21iSG53VitGNnFCZEx2aExnK1Q1L2hwQnVlMlIyT0R4czhMWTFNSnQ0em5JbUJ6dHJ4Y0NaeWYzRzIvYjZqWVRGa0JORldNWXF4d1loUjBYQ092OVBWS1UrSXpvRFpjSTZuVmcxKzFXYmNyWDRxMDRqbWllWTBkM2JpcTgwdDQyNVJKbEl2OHQzQTdiVjZXcDZEcm5GamlrOVFraXZabnRXeENWY0FTdy9UZ3BIcHB3YXMySXZjcGE2RWt3TnY2WnJlQWlpcUErK3RZTXUvdXNUOVhKb25WRDhNbk5pZXZoZjhsOUZVS29JWDUyUUhQaDdvUm5PTk5tLzRiTFoyYXNUdTZXSkxENWhhSm5adXRyNTdqZXJRN0NEWUlOY0QxRUxneWhkQkRIUUNOWHFMMnlSVC82aHh6b1Y1MzZ2WUMyL2RUakZiOWNJMnR3dFc4bGRMWXJ0NzZ4RllwWlNRQnhSZjNOOHl4aFJkUTMydFRwQSt6VW9nUXQrSjhrZ1pHem9NTVpxekZuMWdjR0t5QjcvYzVWK1N2eUNSeHJHNWdqbDNYM2JSZGdjd2dmNnUrUGlCQVJhS0VuNmNvRTg2aWczZEl4REpiWEtHMEJzY1YyRnc5Z2RObEZ6emJyZE55VnQvazMrVG5qTUYvK1p2ZEdUUzlDV1gzRDUydWlvcWJ4WWJlZWxQYkgzcDFBNGxycUlyVVBTbE1DRWJDR0dIcmFnSFpBZDI2S2NsT3R1TE9Ma0s0TlVIVlNDN1hscGhmTXNRZjN0UHU1VTJ3Wnh4VCtCRHUzSXRzWXkzcnFvb2wzV0RYcTJ0NzVzWjdTUEZKWWE5aDZ5cVd2QkdKOGdYS3MxMmJPNDdNL2RzSVNuN2xaQUJLRlg5dXp2eVBEVU5FdkpOalJHaFFiRTRtSlh3K2xrM3V3UlF5ajZiUExhVzJiWmdwb3F1WGc3TythVGNoS2Qra08vaTRNV1ZZOHE2djBiNWMxUldaNzc5TU1oQWlBVWdaSnVzSkJmYlNNSEpScjNxMzhwNEVjNjNQUGxhbzZCaG0yQzQxek5kSGdtOGhadGxScHdCbW1lZTBVclUwaEUxZGlIWkRLREhwUmZsVmNiTW5pR29GclFjSUdVcXZUS1hHSUFKWTlHTW1GTFQ0dG9hZnM4TFZCQXVQc0k3NmdWbEJEUWJJTzlYdzcwTVJqcGhHRWV2NUdja2tNVWN3TkFTcWJFRzZET1FWOUxNbG5Fa25tNFVrb3BDdXlJN25QQm9EQVV0MnFBUmRtY2JNSDh6OHRKcWdqYXIvQ2lBTnozakNzbVRUOEtyS2xTbUdLWWxTYzQxb3hBeXpXTHJlTkNVVDNDVnNiei83WVIwTW82Vlc2aFVvMXBCM2c0UFF0eFV2c3FRYU05UHdiUEV6VkhoQmpubTI5OGhDaVBiaDZlME1PSTh1bzZvV0t0aEYwcG9uc0laSTgwbFg0VHo3Qm5ROU9MVWc0cEk1SUk1KzVOZ05OYzBTN3Myb09zRWRCWnJlVkczNUpnR2w5bC8zUGFZUk5wOWxzR2h3OTBsc0hwMGkvaVRvd085S2RaeEFSZjdkYjMrUE8wMCtWNGxyeWdRVTdUMUd6M1BjMlZXU3B2VkZmeXQrVEtjYlBJR0NobWgya0JnOFgxZjluUzZqWXdib2FYdWlDalV6K2Y0ejBNWE9MNnhBYmRocDI3ZnJtSUlmVS9KMTFRdVJLcGpWNmhUUktYNTFzOWt6a1htbjlRMjJKVCtWZGxlWFZUYTMyNHUvNE55UElmakprcll6bmhnQTVXNnp6UkRHREpwN09rbVVWVlVEM0VqNi96VnFEeFNaenMyaVhIcDltZXlBK0hBT1hmM0RMajNXNUVkdHp5OFV6cGpzc2M0UTdidVVQWVp4alQ2SU1WbmN0K2xxeWVIbWlEUURJVjVSL2Vnd2hRVXpUdk5USVQ2WU43TnNqNjludHIwSjFuM0syaUNvaU84NWNkR3hVRzg4KzBxWk12TXZGVVM2MEhUTEQ4dGRCQ0VkQjNhOW1XYUlycGUySzhWdURnbUdiZGZCRk9wNDBWQVFDK3p5MDlyZXVxQzN5UkRpbzFYck9QdU54MU0rRVl3aDk3T3FUTTBGanY4ZFYxVTRQVm5meG1wNWlLZi9ZejhlYU5TVzZRYmovalUxUEltSWRCdWVBY2FUby95aGJMZ1lIODJSdG9yNml2akgzbTJCWEJ2WUVTVFlIMDcwV3J3K0tkTk0xUU5rVWRDYUVRTTF1UHFleCtocnlJQlgwb2J2Nko2YTQ1YnVvUG1FNUg5aUZFWSswNUFqMXJGdWN2YmpiamF4NmExRmk0dHlhTFllYU1OZ1pUQWVHNnhlU1Z2QjE1VU9GaEcyM3E5MGNQTjhVL3dEOTlCWWduNVVFM3hueTR5a2N0T21JUSthcUZEVm8zYmYwem9nWmZ2M1VrOE5KTlo2ZEVXenRGcVBESkJHellNc3QxNWw3Qk5IU2MrMlAxUWE5SW94WTNWcWN1QkM1YTlqWjBrcldtOVQ4dXl4ajk2d3VCU0FoNkNXMkJOSTBYaFc3dnFTY1VuRUFpaExuaFQ3MThLRHIweGg1dys0YW4xR1A3dXd4SXNsOUc3SmIvR1NCOE1qUy9McGFCbWJiMUQ2MTFQcysyQmtQVXMyY0pXTitMcFNtRjhiSGpNV2hxelp6NGljT05mUmI5Mlo2S2cvTzNXMTdsbTN4aktDajVQSytHV2FkeDR6cEhCcVR4RnQ5anVNZDNFWFdYLytiZ2N4OWVUSUk1emlVSzlPbkRoUnVJQ2ppNzJYbDZmL25oUEsyU3Y1bGkzU0p3UmJ2L3kwVlMrZEdBVEg3WklRY3EvTTRKMjNlRkZrTy81VUtDaG1qN2JkNThEcGEwZjhsY29hWTEwU0tLUUtUTVRuMDB5UGtNZURROVA5c2RRQUVHK01vZDRhRVh2QytuMmhPL2JZUmtMTGtRZm1mbUhjV2VTUlVSRkZySHo1QUlmeTlkMjl1cFRTU21UeHEwWngxelc3MVNGWWVzZW9ZeFJmWUo5QUpzb3J3L2M3dldlUDgxc25QN2hiRFJPUnRCaTBtVzRBbVZxVnAyaG9veGljdmtuQ3EweUFSNmN6MmU1QjRQd1RpTUdnNXlKN1JNMkJsa01lVFZPSDc0cmxQS0Z5RmtsNkpmZXU1dzYxUlRIUUxaalM3NndMNGY3TG5UUkdMcy9XLzZPd3ovNDRHV1psWERyb0M0azVvd2NVMUtyaElsaGxVQkNhZzhRcGU2M2ljVFRnRDg3bHRTK3Z0N2YvaVJrVWNVK1g1YmUyNFJodU9YZkYwRHRtdUhGMTBvMVhUQlFMdEkrR0ZZOHV0eXdEcDFTRUxBbTY3R3JXSTNRV05tUDgrV2E4ZmdmV0w3L0xCd3ZiSEkzZnFVQ1JGNnRDL3NMalhVazFDN05Eb0dJb3FzREFxWXVsdk1zLzdsL25PL0Y1WWVLZEtJQk10V3Y0MTBKaGhQdnliL0ozWm0vV1d2ZTErTVQ0djJTa2JqemtxQytoVk04bW9ocWlaRjZVYjZwVFlGOGVkaW93L202bTgweFRiYTZOZkltTnVvUVRFWGFPalYwcXlqdVRpSWhnbHZoc3pSQ2phQ2JXNzUrajAxTXljR2l0RnFOTVZRUUhEWU1kZkdJdmkvUWJlV3Q3SUF1VHY0UzJuT3hxeUpNdXpXYnA1ai9Sa1gvdkcybjhjK1hVaEd4dEtvNHhIaWkxcXlibmRUekR1YnY3VHE0SERTQVVhZlRMMSt3S1NXUUR6L2dJMUhIT1UrOHVpbHZRdDlkQkh1b0FDN29GY0o4VUJxYWRWQTR6TjZ5djIzNWJSbTlGYXJhNlNMajBJRWM9LjNFRTdMVklEdGR2Njh3LTZpelFTWTlqT3VQRzV6MVhlT3AtU0NTYXIwZ054QXRKTVB4eE5yd1YwOWtnNDFRLTMwMlBNSXk2dGRvSk1TWEF5YTJhWm5B",
    "_eventId":"submit",
    "geolocation":""
}

userAgent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Edg/87.0.664.66"
headers={'User-agent':userAgent}
#构造Session
session = requests.Session()

req=session.post(baseurl,data=first_data,headers=headers)

# print(context.decode("utf-8"))
print(session.cookies.get_dict())
second_url="https://mysso.cust.edu.cn/cas/login?service=https://jwgl.cust.edu.cn/welcome" #得到

req=session.get(url=second_url)
print(session.cookies.get_dict())
third_url="http://mysso-cust-edu-cn-s.webvpn.cust.edu.cn:8118/"
req=session.get(url=third_url)
print(session.cookies.get_dict())

url_4="http://jwgls0-cust-edu-cn-s.webvpn.cust.edu.cn:8118/api/LoginApi/LGSSOLocalLogin?sf_request_type=ajax" # 请求    ASP.NET_SessionId


data_4={"param":"JTdCJTIyVGlja2V0JTIyJTNBJTIyU1QtNDAxMjIxNy04Q3oxVExIcTVIbkNNdlFNTWlS"}
req=session.post(url_4,data=data_4)
print(session.cookies.get_dict())
url_5="https://jwgls1.cust.edu.cn/api/ClientStudent/Home/StudentHomeApi/QueryStudentScheduleData" # 请求 课表
data_5={"param":"JTdCJTdE","__permission":{"MenuID":"00000000-0000-0000-0000-000000000000","Operation":0},"__log":{"MenuID":"00000000-0000-0000-0000-000000000000","Logtype":6,"Context":"查询"}}
req=session.post(url_5,data=data_5)
print(session.cookies.get_dict())
print(req.content.decode("utf-8"))

